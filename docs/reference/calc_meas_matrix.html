<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate the measurement matrix given N observations and G grid points — calc_meas_matrix • baydem</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate the measurement matrix given N observations and G grid points — calc_meas_matrix" />
<meta property="og:description" content="tau is a vector of calendar dates indexed from g = 1,2,...,G. phi_m is a
vector of n = 1,2,...,N radiocarbon determinations (fraction modern) with
associated uncertainties sig_m. Calculate the measurement matrix M, which
has dimensions N x G and for which each element is M_ig = p(phi_m,i|tau_g).
The total uncertainty of the measurement comes from measurement error (SIG_M,
calculated using the measurement error for each measurement) and the
calibration curve error (SIG_c, calculated using the uncertainty for the
calibration curve at each grid point). These uncertainties (and the
associated measurements) should already be &quot;projected&quot; to 1950 equivalents.
By default the measurement matrix, M, is multiplied by dtau so that M * f is
an approximation to the integral over p(t|th) * p(phi|t) using a Riemann sum
with the density calculated at the points tau and the width for each point
being dtau. Alternatively, the trapezoidal rule can be used (for details see
calc_trapez_weights). If the spacing of tau is irregular, the trapezoidal
rule must be used. An error is thrown if tau is irregularly spaced and the
trapezoidal rule is not used" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">baydem</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/standard_pipeline.html">Summarizing sets of radiocarbon dates using baydem's standard pipeline</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/eehh-stanford/baydem/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate the measurement matrix given N observations and G grid points</h1>
    <small class="dont-index">Source: <a href='https://github.com/eehh-stanford/baydem/blob/master/R/radiocarbon_functions.R'><code>R/radiocarbon_functions.R</code></a></small>
    <div class="hidden name"><code>calc_meas_matrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>tau is a vector of calendar dates indexed from g = 1,2,...,G. phi_m is a
vector of n = 1,2,...,N radiocarbon determinations (fraction modern) with
associated uncertainties sig_m. Calculate the measurement matrix M, which
has dimensions N x G and for which each element is M_ig = p(phi_m,i|tau_g).
The total uncertainty of the measurement comes from measurement error (SIG_M,
calculated using the measurement error for each measurement) and the
calibration curve error (SIG_c, calculated using the uncertainty for the
calibration curve at each grid point). These uncertainties (and the
associated measurements) should already be "projected" to 1950 equivalents.
By default the measurement matrix, M, is multiplied by dtau so that M * f is
an approximation to the integral over p(t|th) * p(phi|t) using a Riemann sum
with the density calculated at the points tau and the width for each point
being dtau. Alternatively, the trapezoidal rule can be used (for details see
calc_trapez_weights). If the spacing of tau is irregular, the trapezoidal
rule must be used. An error is thrown if tau is irregularly spaced and the
trapezoidal rule is not used</p>
    </div>

    <pre class="usage"><span class='fu'>calc_meas_matrix</span><span class='op'>(</span>
  <span class='va'>tau</span>,
  <span class='va'>phi_m</span>,
  <span class='va'>sig_m</span>,
  <span class='va'>calib_df</span>,
  add_calib_unc <span class='op'>=</span> <span class='cn'>T</span>,
  use_trapez <span class='op'>=</span> <span class='cn'>F</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>tau</th>
      <td><p>A vector of calendar dates indexed by g</p></td>
    </tr>
    <tr>
      <th>phi_m</th>
      <td><p>A vector of fraction moderns indexed by i</p></td>
    </tr>
    <tr>
      <th>sig_m</th>
      <td><p>A vector of standard deviations for phi_m indexed by i</p></td>
    </tr>
    <tr>
      <th>calib_df</th>
      <td><p>Calibration curve (see load_calib_curve)</p></td>
    </tr>
    <tr>
      <th>add_calib_unc</th>
      <td><p>Whether to add calibration uncertainty (default: <code>TRUE</code>)</p></td>
    </tr>
    <tr>
      <th>use_trapez</th>
      <td><p>Whether to use the trapezoidal rule for integration
(default: <code>FALSE</code>)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The measurement matrix, which has dimensions N x G</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael Holton Price.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


